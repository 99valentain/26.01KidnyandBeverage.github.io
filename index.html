<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2026 ì‹ ì¥ ê±´ê°• ì—°êµ¬ì†Œ</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.8/dist/web/static/pretendard.css" />

    <style>
        body {
            font-family: 'Pretendard', sans-serif;
            transition: background 0.5s ease;
            min-height: 100vh;
            overflow-x: hidden;
        }
        /* ë‚® í…Œë§ˆ */
        body.day-mode { background: linear-gradient(135deg, #E0F2FE 0%, #F0F9FF 100%); color: #1E293B; }
        /* ë°¤ í…Œë§ˆ */
        body.night-mode { background: linear-gradient(135deg, #0F172A 0%, #1E293B 100%); color: #F1F5F9; }

        .mobile-card { 
            border-radius: 1.5rem; 
            backdrop-blur: 10px; 
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }
        .day-mode .mobile-card { background: rgba(255, 255, 255, 0.8); shadow: 0 4px 15px rgba(0,0,0,0.05); }
        .night-mode .mobile-card { background: rgba(30, 41, 59, 0.7); border-color: rgba(255,255,255,0.1); }

        /* ë–¨ì–´ì§€ëŠ” ì…ì */
        .falling-item {
            position: fixed; top: -20px; z-index: 9999; user-select: none; pointer-events: none;
            animation: fall linear infinite;
        }
        @keyframes fall {
            0% { transform: translateY(0) rotate(0deg); }
            100% { transform: translateY(110vh) rotate(360deg); }
        }

        /* ì»µ ìŒ“ê¸° ì• ë‹ˆë©”ì´ì…˜ */
        .cup-stack-item {
            display: inline-block;
            animation: bounceInUp 0.5s ease-out;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
        }
    </style>
</head>
<body class="antialiased pb-20 day-mode">

    <!-- ë‚®/ë°¤ í† ê¸€ ë²„íŠ¼ -->
    <div class="fixed top-5 right-5 z-[10000]">
        <button onclick="toggleTheme()" id="theme-btn" class="bg-white/80 backdrop-blur-md p-3 rounded-full shadow-lg border border-sky-100 text-xl active:scale-90 transition">
            â˜€ï¸
        </button>
    </div>

    <main class="max-w-3xl mx-auto px-4 py-8 space-y-10 relative z-10">

        <!-- í—¤ë” -->
        <header class="text-center space-y-2">
            <span class="text-4xl animate-bounce inline-block">ğŸ«˜</span>
            <h1 id="main-title" class="text-2xl font-black">2026 ì‹ ì¥ ê±´ê°• ì—°êµ¬ë…¸íŠ¸</h1>
            <p id="sub-title" class="text-sm opacity-70">ìŒë£Œê°€ ìš°ë¦¬ ì‹ ì¥ì— ë¯¸ì¹˜ëŠ” ì˜í–¥</p>
        </header>

        <!-- ì„¹ì…˜ 1: ì‹ ì¥ ë‹¤ë§ˆê³ ì¹˜ -->
        <section class="mobile-card p-6 relative overflow-hidden">
            <div class="text-center mb-6">
                <div id="kidney-char" class="text-[100px] mb-2 transition-all duration-500 cursor-pointer" onclick="pokeKidney()">ğŸ«˜</div>
                <h2 id="status-title" class="text-2xl font-bold">ë§¤ìš° ê±´ê°•í•¨</h2>
                <p id="status-desc" class="text-sm opacity-70">ì‹ ì¥ì´ í™œê¸°ì°¨ê²Œ ì‘ë™ ì¤‘ì…ë‹ˆë‹¤!</p>
            </div>

            <!-- ì‹ ì¥ ë‚˜ì´ ìŠ¬ë¼ì´ë” (ì•„ì´ë””ì–´ 2 ì ìš©) -->
            <div class="bg-white/30 p-4 rounded-2xl mb-6">
                <label class="text-xs font-bold mb-2 block">ğŸ” ì‹ ì¥ ë‚˜ì´ ì§„ë‹¨ ìŠ¬ë¼ì´ë” (ì‹¤ì œ ë‚˜ì´: <span id="age-val">25</span>ì„¸)</label>
                <input type="range" id="age-slider" min="10" max="90" value="25" class="w-full h-2 bg-sky-200 rounded-lg appearance-none cursor-pointer accent-sky-600" oninput="updateAge(this.value)">
                <div class="flex justify-between text-[10px] mt-2 opacity-50">
                    <span>10ì„¸</span><span>90ì„¸</span>
                </div>
                <p class="text-center text-xs mt-3 font-bold" id="age-result">ë‹¹ì‹ ì˜ ì‹ ì¥ì€ í˜„ì¬ ì—°ë ¹ëŒ€ í‰ê·  ìˆ˜ì¤€ì…ë‹ˆë‹¤.</p>
            </div>

            <!-- ìŒë£Œ ë²„íŠ¼ -->
            <div class="grid grid-cols-4 gap-2 mb-4">
                <button onclick="addDrink('tea', 'ğŸµ')" class="bg-emerald-100/50 p-3 rounded-xl flex flex-col items-center hover:bg-emerald-100 transition"><span class="text-2xl">ğŸµ</span><span class="text-[10px] mt-1 font-bold">ì°¨</span></button>
                <button onclick="addDrink('black', 'â˜•')" class="bg-slate-100/50 p-3 rounded-xl flex flex-col items-center hover:bg-slate-100 transition"><span class="text-2xl">â˜•</span><span class="text-[10px] mt-1 font-bold">ì»¤í”¼</span></button>
                <button onclick="addDrink('mix', 'ğŸ¬')" class="bg-amber-100/50 p-3 rounded-xl flex flex-col items-center hover:bg-amber-100 transition"><span class="text-2xl">ğŸ¬</span><span class="text-[10px] mt-1 font-bold">ë¯¹ìŠ¤</span></button>
                <button onclick="addDrink('ssb', 'ğŸ¥¤')" class="bg-rose-100/50 p-3 rounded-xl flex flex-col items-center hover:bg-rose-100 transition"><span class="text-2xl">ğŸ¥¤</span><span class="text-[10px] mt-1 font-bold">ê°€ë‹¹</span></button>
            </div>

            <button onclick="resetDrinks()" class="w-full py-2 text-xs opacity-50 underline">ëª¨ë‘ ë¦¬ì…‹í•˜ê¸°</button>
        </section>

        <!-- ì„¹ì…˜ 2: ì‹œê°ì  ì»µ ìŒ“ê¸° (ì•„ì´ë””ì–´ 1 ì ìš©) -->
        <section class="mobile-card p-6">
            <h3 class="text-sm font-bold mb-4 flex items-center gap-2">ğŸ¥¤ ì˜¤ëŠ˜ ë§ˆì‹  ìŒë£Œ ë¡œê·¸ <span id="cup-count" class="text-sky-500">(0)</span></h3>
            <div id="cup-stack" class="min-h-[100px] border-2 border-dashed border-sky-200 rounded-2xl p-4 flex flex-wrap gap-2 items-end justify-start">
                <!-- ì»µ ì•„ì´ì½˜ë“¤ì´ ì—¬ê¸°ì— ìŒ“ì„ -->
                <p id="cup-placeholder" class="text-xs opacity-30 w-full text-center">ìŒë£Œë¥¼ ì¶”ê°€í•˜ë©´ ì—¬ê¸°ì— ìŒ“ì…ë‹ˆë‹¤.</p>
            </div>
        </section>

        <!-- ì„¹ì…˜ 3: AI í•˜ëŠ˜ì”¨ -->
        <section id="chat" class="mobile-card h-[400px] flex flex-col overflow-hidden shadow-xl">
            <div class="p-4 bg-sky-500 text-white font-bold flex justify-between items-center">
                <span>ğŸ‘©â€ğŸ”¬ AI í•˜ëŠ˜ì”¨.</span>
                <span class="text-[10px] bg-white/20 px-2 py-1 rounded">ì‹¤ì‹œê°„ ë¶„ì„ ì¤‘</span>
            </div>
            <div id="chat-window" class="flex-1 p-4 overflow-y-auto space-y-4 text-sm"></div>
            <div class="p-4 bg-white/50 border-t flex gap-2">
                <input type="text" id="chat-input" placeholder="ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”..." class="flex-1 bg-white border-0 rounded-xl px-4 py-2 focus:ring-2 focus:ring-sky-400">
                <button onclick="handleChat()" class="bg-sky-600 text-white px-4 rounded-xl">ì „ì†¡</button>
            </div>
        </section>

        <footer class="text-center opacity-60 text-[11px] leading-relaxed">
             Â© (2026) í•˜ëŠ˜ì”¨ : AIê°€ ê±°ì§“ë§ì„ ì•„ì£¼ ì˜í•´ì„œìš”..<br>
                ì‚¬ì‹¤ ê¸°ë°˜ ê·¼ê±°ìë£Œê°€ ì•„ë‹Œ ê²ƒì„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìœ¼ë‹ˆ..<br>
                ì£¼ì˜í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤ :)<br>
                ì•„ë‹ˆ ê¸€ì„.. ì œê°€ ë¯¸ë˜ì‹ë‹¨ ì½”í˜¸íŠ¸ ì—°êµ¬íŒ€ì— ìˆë‹¤ì§€ ë­¡ë‹ˆê¹Œ ? ã…‹ã…‹ã…‹ (ê·¸ëŸ¼ ì´ë§Œ)
        </footer>

    </main>

    <script>
        const GEMINI_API_KEY = "AIzaSyDUbyxJarLwFPXHnM7y3nSSeNdrJ0-BSSU";
        let isNight = false;
        const counts = { black: 0, tea: 0, mix: 0, ssb: 0 };

        // 1. ë‚®/ë°¤ í† ê¸€ ê¸°ëŠ¥ (ì•„ì´ë””ì–´ 3 ì ìš©)
        function toggleTheme() {
            isNight = !isNight;
            const body = document.body;
            const btn = document.getElementById('theme-btn');
            const title = document.getElementById('main-title');

            if (isNight) {
                body.className = 'antialiased pb-20 night-mode';
                btn.innerHTML = 'ğŸŒ™';
                title.innerText = 'ğŸŒ™ ì‹ ì¥ì˜ ë°¤ ëª¨ë“œ';
                document.getElementById('kidney-char').innerText = 'ğŸ’¤';
                document.getElementById('status-desc').innerText = 'ì‹ ì¥ë„ íœ´ì‹ì´ í•„ìš”í•œ ì‹œê°„ì…ë‹ˆë‹¤.';
            } else {
                body.className = 'antialiased pb-20 day-mode';
                btn.innerHTML = 'â˜€ï¸';
                title.innerText = '2026 ì‹ ì¥ ê±´ê°• ì—°êµ¬ë…¸íŠ¸';
                updateUI();
            }
        }

        // 2. ë–¨ì–´ì§€ëŠ” ì…ì (â„ï¸/âœ¨/â­)
        function createFallingItem() {
            const item = document.createElement('div');
            item.innerHTML = isNight ? (Math.random() > 0.5 ? 'âœ¨' : 'â­') : (Math.random() > 0.5 ? 'â„ï¸' : 'âœ¨');
            item.classList.add('falling-item');
            item.style.left = Math.random() * 100 + 'vw';
            item.style.fontSize = (Math.random() * 8 + 8) + 'px'; 
            item.style.opacity = Math.random() * 0.5 + 0.3;
            const duration = Math.random() * 5 + 8;
            item.style.animationDuration = duration + 's';
            document.body.appendChild(item);
            setTimeout(() => item.remove(), duration * 1000);
        }
        setInterval(createFallingItem, 600);

        // 3. ì‹ ì¥ ë‚˜ì´ ìŠ¬ë¼ì´ë” (ì•„ì´ë””ì–´ 2 ì ìš©)
        function updateAge(val) {
            document.getElementById('age-val').innerText = val;
            const result = document.getElementById('age-result');
            let score = 100 - (counts.mix * 10) - (counts.ssb * 15);
            
            if (score < 50) {
                result.innerText = `âš ï¸ ì£¼ì˜! ìŒë£Œ ì„­ì·¨ë¡œ ì¸í•´ ì‹ ì¥ ë‚˜ì´ê°€ ${parseInt(val) + 15}ì„¸ ìˆ˜ì¤€ìœ¼ë¡œ ë…¸í™”ë˜ì—ˆìŠµë‹ˆë‹¤!`;
                result.className = "text-center text-xs mt-3 font-bold text-rose-500";
            } else {
                result.innerText = `ì •ìƒ: ë‹¹ì‹ ì˜ ì‹ ì¥ì€ í˜„ì¬ ì—°ë ¹ëŒ€ í‰ê·  ìˆ˜ì¤€ì…ë‹ˆë‹¤.`;
                result.className = "text-center text-xs mt-3 font-bold text-sky-500";
            }
        }

        // 4. ìŒë£Œ ì¶”ê°€ ë° ì»µ ìŒ“ê¸° (ì•„ì´ë””ì–´ 1 ì ìš©)
        function addDrink(type, emoji) {
            if (isNight) {
                alert("ğŸŒ™ ì‹ ì¥ë„ íœ´ì‹ì´ í•„ìš”í•´ìš”! ë°¤ì—ëŠ” ìˆ˜ë¶„ ì„­ì·¨ë¥¼ ì ì ˆíˆ ì¡°ì ˆí•˜ì„¸ìš”.");
                return;
            }
            counts[type]++;
            
            // ì»µ ìŒ“ê¸° ì‹œê°í™”
            const stack = document.getElementById('cup-stack');
            const placeholder = document.getElementById('cup-placeholder');
            if (placeholder) placeholder.remove();
            
            const cup = document.createElement('span');
            cup.innerHTML = emoji;
            cup.className = 'cup-stack-item text-3xl';
            stack.appendChild(cup);
            
            const total = Object.values(counts).reduce((a,b)=>a+b);
            document.getElementById('cup-count').innerText = `(${total})`;
            
            // ì»µì´ ë„ˆë¬´ ë§ì•„ì§€ë©´ í™”ë©´ í”ë“¤ê¸°
            if (total > 8) {
                stack.classList.add('animate__animated', 'animate__shakeX');
                setTimeout(() => stack.classList.remove('animate__shakeX'), 500);
            }
            
            updateUI();
        }

        function resetDrinks() {
            for(let k in counts) counts[k] = 0;
            document.getElementById('cup-stack').innerHTML = '<p id="cup-placeholder" class="text-xs opacity-30 w-full text-center">ìŒë£Œë¥¼ ì¶”ê°€í•˜ë©´ ì—¬ê¸°ì— ìŒ“ì…ë‹ˆë‹¤.</p>';
            document.getElementById('cup-count').innerText = '(0)';
            updateUI();
        }

        function updateUI() {
            if(isNight) return;
            let score = 100 + (counts.black*2) + (counts.tea*3) - (counts.mix*7) - (counts.ssb*12);
            score = Math.max(0, Math.min(100, score));
            
            const char = document.getElementById('kidney-char');
            const title = document.getElementById('status-title');
            
            if(score > 80) { char.innerText = 'ğŸ«˜'; title.innerText = 'ë§¤ìš° ê±´ê°•í•¨'; }
            else if(score > 50) { char.innerText = 'ğŸ™‚'; title.innerText = 'ë³´í†µ'; }
            else { char.innerText = 'ğŸ¤®'; title.innerText = 'ìœ„í—˜!'; }
            
            updateAge(document.getElementById('age-slider').value);
        }

        function pokeKidney() {
            const c = document.getElementById('kidney-char');
            c.classList.add('animate__animated', 'animate__rubberBand');
            setTimeout(() => c.classList.remove('animate__rubberBand'), 1000);
        }

        // 5. AI ì±„íŒ…
        async function handleChat() {
            const input = document.getElementById('chat-input');
            const win = document.getElementById('chat-window');
            if(!input.value) return;
            const msg = input.value;
            win.innerHTML += `<div class="flex justify-end"><div class="bg-sky-600 text-white p-2 rounded-xl rounded-tr-none max-w-[80%]">${msg}</div></div>`;
            input.value = '';
            
            try {
                const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${GEMINI_API_KEY}`, {
                    method: 'POST', headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ contents: [{ parts: [{ text: msg }] }] })
                });
                const data = await res.json();
                const reply = marked.parse(data.candidates[0].content.parts[0].text);
                win.innerHTML += `<div class="flex gap-2"><div class="w-8 h-8 bg-sky-100 rounded-full flex-shrink-0 flex items-center justify-center">ğŸ‘©â€ğŸ”¬</div><div class="bg-white/80 p-3 rounded-2xl rounded-tl-none shadow-sm">${reply}</div></div>`;
            } catch(e) { win.innerHTML += `<div class="text-center text-xs text-rose-400">ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</div>`; }
            win.scrollTop = win.scrollHeight;
        }

        document.getElementById('chat-input').addEventListener('keypress', (e)=>{ if(e.key==='Enter') handleChat(); });
    </script>
</body>
</html>
